<!DOCTYPE html>
<html>
<body>
  
  <script src="http://code.jquery.com/jquery-2.1.3.min.js"></script>
  <script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
  
  <label style="color:red" for="searchingFor">What name do you want to display?</label>
  <textarea cols="40" rows="8" name="searchingFor" id="searchingFor"></textarea>
  <br></br>
  
  <label for="searchingFor">What is the name of the slack channel you would like to join? Don't put the # symbol, just the name</label>
  <textarea cols="40" rows="8" name="searchingFor2" id="searchingFor2"></textarea>
  <br></br>
  
  <label for="searchingFor">What message would you like to send?</label>
  <textarea cols="40" rows="8" name="searchingFor3" id="searchingFor3"></textarea>
  <br></br>
  
  <label for="searchingFor">What is the URL of the photo of your icon?</label>
  <textarea cols="40" rows="8" name="searchingFor4" id="searchingFor4"></textarea>
  <br></br>

  <button type="submit" id="b-cancel">Cancel</button>
  <button type="submit" id="b-submit">Submit</button>
</body>

<script>
      function saveOptions() {
        var options = {
              'name': document.getElementById("searchingFor").value,
              'channel' : document.getElementById("searchingFor2").value,
              'text' : document.getElementById("searchingFor3").value,
              'imageURL' : document.getElementById("searchingFor4").value
        }
        return options;
      }
      $().ready(function() {
       if (typeof window.localStorage !== "undefined") {
       	console.log("Not undefined :)");
        if (window.localStorage.pebble_doc2_weather_options) {
          ls_pto = JSON.parse(window.localStorage.pebble_doc2_weather_options);
            //Sober
            $("input[name=soberPhrase1]").val(ls_pto["soberPhrase1"]);
        }
       }
        $("#b-cancel").click(function() {
          console.log("Cancel");
          document.location = "pebblejs://close";
        });
        $("#b-submit").click(function() {
          console.log("Submit");
          ls_pto = JSON.stringify(saveOptions());
          if (typeof window.localStorage !== "undefined") {
            window.localStorage.pebble_doc2_weather_options = ls_pto;
          }
          var location = "pebblejs://close#" + encodeURIComponent(ls_pto);
          console.log("Warping to: " + location);
          console.log(location);
          document.location = location;
        });
      });
    </script>
</html>
